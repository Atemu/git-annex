I am trying to configure an S3 remote that uses minio. My minio installation seems to be working fine since aws cli seems to work well with it. However, when I try to enable git-annex, it seems to fail.

~~~
$ git-annex initremote minio1 --debug type=S3 encryption=none host=localhost port=9000 type=S3 bucket=mybucket
[2020-06-18 15:54:33.790603] read: git ["--git-dir=.git","--work-tree=.","--literal-pathspecs","show-ref","git-annex"]
[2020-06-18 15:54:33.809088] process done ExitSuccess
[2020-06-18 15:54:33.809176] read: git ["--git-dir=.git","--work-tree=.","--literal-pathspecs","show-ref","--hash","refs/heads/git-annex"]
[2020-06-18 15:54:33.817935] process done ExitSuccess
[2020-06-18 15:54:33.81966] read: git ["--git-dir=.git","--work-tree=.","--literal-pathspecs","log","refs/heads/git-annex..6c06bbc19665ed251ce580b99dcfc8a85f3381dc","--pretty=%H","-n1"]
[2020-06-18 15:54:33.831334] process done ExitSuccess
[2020-06-18 15:54:33.831451] read: git ["--git-dir=.git","--work-tree=.","--literal-pathspecs","log","refs/heads/git-annex..116aa90151930ec19220a11be01392617206b84f","--pretty=%H","-n1"]
[2020-06-18 15:54:33.842421] process done ExitSuccess
[2020-06-18 15:54:33.844598] chat: git ["--git-dir=.git","--work-tree=.","--literal-pathspecs","cat-file","--batch"]
[2020-06-18 15:54:33.845888] chat: git ["--git-dir=.git","--work-tree=.","--literal-pathspecs","cat-file","--batch-check=%(objectname) %(objecttype) %(objectsize)"]
[2020-06-18 15:54:33.891102] read: git ["config","--null","--list"]
[2020-06-18 15:54:33.896992] process done ExitSuccess
[2020-06-18 15:54:33.89713] read: git ["config","--null","--list"]
[2020-06-18 15:54:33.90295] process done ExitSuccess
initremote minio1 (checking bucket...) [2020-06-18 15:54:33.990977] String to sign: "GET\n\n\nThu, 18 Jun 2020 22:54:33 GMT\n/mybucket/annex-uuid"
[2020-06-18 15:54:33.991028] Host: "mybucket.localhost"
[2020-06-18 15:54:33.991053] Path: "/annex-uuid"
[2020-06-18 15:54:33.991074] Query string: ""
[2020-06-18 15:54:33.991093] Header: [("Date","Thu, 18 Jun 2020 22:54:33 GMT"),("Authorization","AWS user:key1")]
[2020-06-18 15:54:34.002157] Response status: Status {statusCode = 403, statusMessage = "Forbidden"}
[2020-06-18 15:54:34.002225] Response header 'Accept-Ranges': 'bytes'
[2020-06-18 15:54:34.00225] Response header 'Content-Length': '379'
[2020-06-18 15:54:34.00227] Response header 'Content-Security-Policy': 'block-all-mixed-content'
[2020-06-18 15:54:34.002289] Response header 'Content-Type': 'application/xml'
[2020-06-18 15:54:34.002308] Response header 'Server': 'MinIO/RELEASE.2020-06-18T02-23-35Z'
[2020-06-18 15:54:34.002327] Response header 'Vary': 'Origin'
[2020-06-18 15:54:34.002345] Response header 'X-Amz-Request-Id': '1619C54C20441E6F'
[2020-06-18 15:54:34.002363] Response header 'X-Xss-Protection': '1; mode=block'
[2020-06-18 15:54:34.002382] Response header 'Date': 'Thu, 18 Jun 2020 22:54:34 GMT'
[2020-06-18 15:54:34.002419] Response metadata: S3: request ID=<none>, x-amz-id-2=<none>
[2020-06-18 15:54:34.002483] String to sign: "GET\n\n\nThu, 18 Jun 2020 22:54:34 GMT\n/mybucket/"
[2020-06-18 15:54:34.002509] Host: "mybucket.localhost"
[2020-06-18 15:54:34.002529] Path: "/"
[2020-06-18 15:54:34.002547] Query string: ""
[2020-06-18 15:54:34.002567] Header: [("Date","Thu, 18 Jun 2020 22:54:34 GMT"),("Authorization","AWS user:key2")]
[2020-06-18 15:54:34.003642] Response status: Status {statusCode = 403, statusMessage = "Forbidden"}
[2020-06-18 15:54:34.0037] Response header 'Accept-Ranges': 'bytes'
[2020-06-18 15:54:34.003733] Response header 'Content-Length': '334'
[2020-06-18 15:54:34.003754] Response header 'Content-Security-Policy': 'block-all-mixed-content'
[2020-06-18 15:54:34.003773] Response header 'Content-Type': 'application/xml'
[2020-06-18 15:54:34.003905] Response header 'Server': 'MinIO/RELEASE.2020-06-18T02-23-35Z'
[2020-06-18 15:54:34.003933] Response header 'Vary': 'Origin'
[2020-06-18 15:54:34.003956] Response header 'X-Amz-Request-Id': '1619C54C205CA047'
[2020-06-18 15:54:34.003978] Response header 'X-Xss-Protection': '1; mode=block'
[2020-06-18 15:54:34.004] Response header 'Date': 'Thu, 18 Jun 2020 22:54:34 GMT'
[2020-06-18 15:54:34.004133] Response metadata: S3: request ID=1619C54C205CA047, x-amz-id-2=<none>
(creating bucket in US...) [2020-06-18 15:54:34.004225] String to sign: "PUT\n\n\nThu, 18 Jun 2020 22:54:34 GMT\n/mybucket/"
[2020-06-18 15:54:34.004252] Host: "mybucket.localhost"
[2020-06-18 15:54:34.004274] Path: "/"
[2020-06-18 15:54:34.004293] Query string: ""
[2020-06-18 15:54:34.004312] Header: [("Date","Thu, 18 Jun 2020 22:54:34 GMT"),("Authorization","AWS user:key3")]
[2020-06-18 15:54:34.015873] Response metadata: S3: request ID=<none>, x-amz-id-2=<none>

git-annex: HttpExceptionRequest Request {
  host                 = "mybucket.localhost"
  port                 = 9000
  secure               = False
  requestHeaders       = [("Date","Thu, 18 Jun 2020 22:54:34 GMT"),("Authorization","<REDACTED>")]
  path                 = "/"
  queryString          = ""
  method               = "PUT"
  proxy                = Nothing
  rawBody              = False
  redirectCount        = 10
  responseTimeout      = ResponseTimeoutDefault
  requestVersion       = HTTP/1.1
}
 NoResponseDataReceived
failed
~~~

Any ideas on what this could be because of? Creating buckets, listing content, everything seems to work well with aws cli. I am guessing it's some compatibility issue but no idea where to start looking.

Are there more logs maybe?

